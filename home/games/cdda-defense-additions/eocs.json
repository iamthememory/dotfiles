[
  {
    "type": "effect_on_condition",
    "id": "EOC_FORCE_RECONFIGURE_DEFENSE_MODE",
    "effect": [
      { "open_dialogue": { "topic": "TALK_DEFENSE_MODE_MAIN_MENU" } }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "DEFENSE_MODE_FORTRESS_TRAP",
    "global": true,
    "recurrence": 100,
    "effect": [ ]
  },
  {
    "type": "effect_on_condition",
    "id": "DEFENSE_MODE_WAVE_CONTROL",
    "recurrence": [ "12 hours", "4 day" ],
    "global": true,
    "effect": [
      { "u_teleport": { "global_val": "your_spawnpoint" } },
      { "math": [ "wave_number++" ] },
      { "u_message": "Welcome to wave <global_val:wave_number>!", "type": "bad", "popup": false },
      { "run_eocs": "DEFENSE_MODE_WAVE_SPECIAL_DECIDER" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "DEFENSE_MODE_RANDOM_EVENT",
    "recurrence": [ "2 days", "8 days" ],
    "//": "A general EOC for selecting a random event.  Can and should be expanded.",
    "condition": {
      "and": [
        { "math": [ "random_events_allowed == 0" ] },
        { "not": { "is_weather": "portal_storm" } },
        { "x_in_y_chance": { "x": 7, "y": 10 } }
      ]
    },
    "effect": [
      {
        "weighted_list_eocs": [
          [ "EOC_DEFENSE_MODE_RANDOM_NPC", 10 ],
          [ "EOC_DEFENSE_MODE_RANDOM_NPC_ROBBER", 6 ],
          [ "EOC_DEFENSE_MODE_BANDIT_ATTACK", 1 ]
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "defense_mode_caravan_spawn",
    "recurrence": [ "1 days", "4 days" ],
    "global": true,
    "condition": { "math": [ "u_monsters_nearby('radius': u_search_radius == 3) <= 0" ] },
    "effect": [
      { "u_spawn_npc": "defense_mode_merchant", "lifespan": "8 hours", "real_count": 1, "min_radius": 2, "max_radius": 3 },
      { "u_message": "A caravan approaches!", "type": "good", "popup": false }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "DEFENSE_MODE_WAVE_SPAWN_AFTERSHOCK",
    "effect": { "run_eocs": "DEFENSE_MODE_WAVE_SPAWN_FALLBACK" }
  },
  {
    "type": "effect_on_condition",
    "id": "DEFENSE_MODE_WAVE_SPAWN_MEGAFAUNA",
    "effect": { "run_eocs": "DEFENSE_MODE_WAVE_SPAWN_FALLBACK" }
  },
  {
    "type": "effect_on_condition",
    "id": "DEFENSE_MODE_WAVE_SPAWN_MYTHOS",
    "effect": { "run_eocs": "DEFENSE_MODE_WAVE_SPAWN_FALLBACK" }
  },
  {
    "type": "effect_on_condition",
    "id": "DEFENSE_MODE_WAVE_SPAWN_CANDY",
    "effect": { "run_eocs": "DEFENSE_MODE_WAVE_SPAWN_FALLBACK" }
  }
]
