[
  {
    "type": "region_settings",
    "id": "reset_holding_dimension",
    "rivers": null,
    "lakes": null,
    "ocean": null,
    "ravines": null,
    "forests": null,
    "forest_trails": null,
    "highways": null,
    "cities": null,
    "forest_composition": "no_forests",
    "map_extras": "no_map_extras",
    "terrain_furniture": "default",
    "weather": "default",
    "place_roads": false,
    "place_specials": false,
    "neighbor_connections": false,
    "default_oter": [
      "open_air",
      "open_air",
      "open_air",
      "open_air",
      "open_air",
      "open_air",
      "open_air",
      "open_air",
      "open_air",
      "open_air",
      "reset_holding_dimension_field",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock",
      "reset_holding_dimension_rock"
    ],
    "default_groundcover": [ [ "t_grass", 1 ] ],
    "feature_flag_settings": { "blacklist": [ "CLASSIC", "LAB", "MAN_MADE", "MILITARY", "URBAN", "FARM", "EXODII" ], "whitelist": [  ] },
    "connections": {
      "intra_city_road_connection": "local_road",
      "inter_city_road_connection": "local_road",
      "trail_connection": "forest_trail",
      "sewer_connection": "sewer_tunnel",
      "subway_connection": "subway_tunnel",
      "rail_connection": "local_railroad"
    }
  },
  {
    "type": "mapgen",
    "om_terrain": [ "reset_holding_dimension_field" ],
    "weight": 3,
    "object": { "fill_ter": "t_grass" }
  },
  {
    "type": "overmap_terrain",
    "id": "reset_holding_dimension_field",
    "name": "endless field",
    "sym": "G",
    "color": "green",
    "see_cost": "none",
    "flags": [ "NO_ROTATE" ]
  },
  {
    "type": "mapgen",
    "om_terrain": [ "reset_holding_dimension_rock" ],
    "weight": 3,
    "object": { "fill_ter": "t_rock" }
  },
  {
    "type": "overmap_terrain",
    "id": "reset_holding_dimension_rock",
    "name": "endless rock",
    "sym": "R",
    "color": "brown",
    "see_cost": "none",
    "flags": [ "NO_ROTATE" ]
  },
  {
    "id": "reset_default_dimension_spell",
    "type": "SPELL",
    "name": "Teleport to A New World",
    "description": "Teleport to a new world, resetting the default dimension.",
    "valid_targets": [ "self" ],
    "spell_class": "NONE",
    "flags": [
      "NO_EXPLOSION_SFX",
      "NO_FAIL",
      "NO_HANDS",
      "NO_LEGS",
      "NO_PROJECTILE",
      "SILENT"
    ],
    "effect": "effect_on_condition",
    "effect_str": "EOC_RESET_DEFAULT_DIMENSION_CONFIRM",
    "shape": "blast",
    "base_casting_time": 0
  },
  {
    "id": "EOC_GIVE_RESET_DEFAULT_DIMENSION_SPELL",
    "type": "effect_on_condition",
    "recurrence": "1 seconds",
    "deactivate_condition": {
      "math": [ "u_spell_level('reset_default_dimension_spell') >= 0" ]
    },
    "condition": {
      "math": [ "u_spell_level('reset_default_dimension_spell') < 0" ]
    },
    "effect": [
      {
        "math": [ "u_spell_level('reset_default_dimension_spell') = 1" ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_RESET_DEFAULT_DIMENSION_CONFIRM",
    "condition": {
      "and": [
        { "current_dimension": "" },
        { "not": "u_driving" },
        {
          "u_query": "Really reset the default dimension, and teleport you back to it randomly?",
          "default": false
        }
      ]
    },
    "effect": [
      { "run_eocs": "EOC_RESET_DEFAULT_DIMENSION_START" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_RESET_DEFAULT_DIMENSION_START",
    "condition": {
      "and": [
        { "current_dimension": "" },
        { "not": "u_driving" }
      ]
    },
    "effect": [
      { "u_add_effect": "blind", "duration": "10 seconds" },
      {
        "u_travel_to_dimension": "reset_holding_dimension",
        "npc_travel_radius": 0,
        "region_type": "reset_holding_dimension",
        "npc_travel_filter": "none"
      },
      {
        "u_location_variable": { "context_val": "nearest_floor" },
        "terrain": "t_grass",
        "target_max_radius": 60,
        "min_radius": 0,
        "max_radius": 0
      },
      { "u_teleport": { "context_val": "nearest_floor" } },
      { "run_eocs": "EOC_RESET_DEFAULT_DIMENSION_CLEAR" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_RESET_DEFAULT_DIMENSION_CLEAR",
    "effect": [
      { "clear_dimension": "" },
      {
        "u_message": "Make sure to save now to avoid problems when returning to the default world.",
        "type": "warning",
        "popup": true,
        "popup_w_interrupt_query": true
      },
      { "run_eocs": "EOC_RESET_DEFAULT_DIMENSION_RETURN", "time_in_future": "5 seconds" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_RESET_DEFAULT_DIMENSION_RETURN",
    "effect": [
      { "u_add_effect": "blind", "duration": "10 seconds" },
      {
        "set_string_var": { "mutator": "game_option", "option": "DEFAULT_REGION" },
        "target_var": { "context_val": "default_dimension_region" }
      },
      {
        "u_travel_to_dimension": "",
        "region_type": { "context_val": "default_dimension_region" },
        "npc_travel_radius": 0,
        "npc_travel_filter": "none"
      },
      {
        "u_location_variable": { "context_val": "dimension_return_point" },
        "target_params": {
          "om_terrain": "field",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 300,
          "min_distance": 75,
          "z": 0,
          "cant_see": true,
          "random": true
        }
      },
      { "u_teleport": { "context_val": "dimension_return_point" } },
      { "u_lose_effect": "blind" },
      { "run_eocs": "EOC_RESET_DEFAULT_DIMENSION_CLEANUP", "time_in_future": "1 seconds" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_RESET_DEFAULT_DIMENSION_CLEANUP",
    "effect": [
      { "clear_dimension": "reset_holding_dimension" }
    ]
  }
]
